import{I as Re,d as b,r as d,D as g,m as i,q as _,s as l,t as R,v as f,x as w,J as z,T as he,_ as P,c as E,K as Ie,L as ke,M as Te,N as Be,O as De,P as S,o as Y,e as be,Q as N,R as ee,S as v,U as se,V as Oe,W as O,X as ae,Y as C,Z as Ne,y as ce,$ as Ge,z as oe,A as le,a0 as Fe,a1 as de,a2 as _e,a3 as Z}from"./entry.ed6dc20e.js";const We=""+new URL("logo.74f7c83b.png",import.meta.url).href;function L(e,t){const s=Re(e,t);if(!s)throw new Error(`Could not resolve ${e}`);return s}const ze={class:"board-log"},Ce={class:"difficult"},Se={key:0,class:"next"},Me={key:1,class:"reset"},Ve=b({__name:"GameBoardLog",props:{difficult:{},isNext:{type:Boolean},isReset:{type:Boolean}},setup(e){const t=e,s=d(2);return g(()=>t.difficult,a=>{s.value=a/2+1}),(a,n)=>(i(),_("div",ze,[l("p",Ce," Множитель атаки X*"+R(s.value),1),f(he,{name:"slide-up"},{default:w(()=>[a.isNext?(i(),_("p",Se," - Усиление - ")):a.isReset?(i(),_("p",Me," - Базовая атака - ")):z("",!0)]),_:1})]))}});const Ue=P(Ve,[["__scopeId","data-v-1f79c23c"]]);var m=(e=>(e[e.NONE=0]="NONE",e[e.PREVIEW=1]="PREVIEW",e[e.STARTED=2]="STARTED",e[e.NEXT=3]="NEXT",e[e.RESET=4]="RESET",e))(m||{});const D={EMPTY:0,FILLED:1},Je=b({__name:"BoardItem",props:{field:{},gameStatus:{default:()=>m.NONE}},emits:["select-field"],setup(e,{emit:t}){const s=e,a=E(()=>s.field.value===D.FILLED&&s.gameStatus===m.PREVIEW),n=E(()=>s.field.clicked&&s.field.value===D.FILLED),o=E(()=>s.field.clicked&&s.field.value===D.EMPTY),u=E(()=>{let c="item ";return(a.value||n.value)&&(c+="active"),o.value&&(c+="error"),c}),r=c=>{s.gameStatus===m.STARTED&&t("select-field",c)};return(c,p)=>(i(),_("img",{class:Ie(u.value),onClick:p[0]||(p[0]=h=>r(c.field.id))},null,2))}});const Xe=P(Je,[["__scopeId","data-v-919ce3fb"]]),$e=2,pe=20;function je(e){const t=d($e),s=d([]),a=()=>{s.value=[];for(let n=0;n<e.value;n++)s.value.push({id:n,clicked:!1,value:D.EMPTY})};return g(t,n=>{n>pe&&(t.value=pe)}),console.log(t.value),ke(a),{difficult:t,fields:s,init:a}}const Ee=2e3;function j(e,t){return Math.floor(Math.random()*(t-e))+e}function Ye(e,t,s,a,n,o,u){let r;const c=L("isInitialWidth"),p=d(!1),h=d(!0),$=d(1),x=()=>{o(),e(),V(),y(),c.value=!0,p.value=!0,h.value=!1,u.value=!1},y=()=>{$.value<3&&($.value=$.value+1)},V=()=>{n.value=m.PREVIEW;for(let T=0;T<s.value;){const J=j(0,a.value-1);t.value[J].value!==D.FILLED&&(t.value[J].value=D.FILLED,T=T+1)}clearTimeout(r),r=setTimeout(()=>{n.value=m.STARTED},Ee)},U=E(()=>n.value!==m.PREVIEW&&n.value!==m.NEXT&&$.value<3);return g(n,T=>{(T===m.NEXT||T===m.RESET)&&($.value=0)}),{start:x,canStartGame:U,canReset:p,canResize:h,rerolCount:$}}function Ke(e,t,s,a){let n;const o=$=>{const x=e.value.findIndex(y=>y.id===$);x>-1&&!e.value[x].clicked&&(e.value[x].clicked=!0,u())},u=()=>{if(e.value.findIndex(y=>y.clicked&&y.value===D.EMPTY)>-1){r();return}e.value.findIndex(y=>!y.clicked&&y.value===D.FILLED)===-1&&c()},r=()=>{t.value=m.RESET,s.value=$e},c=()=>{t.value=m.NEXT,clearTimeout(n),n=setTimeout(async()=>{s.value+=2,console.log(s.value),await Te(),a()},Ee)},p=E(()=>t.value===m.NEXT),h=E(()=>t.value===m.RESET);return{selectField:o,isNext:p,isReset:h}}const W={SMALL_FIELD:25,MEDIUM_FIELD:36,LARGE_FIELD:49},M=Be("progressBar",()=>{const e=d(180),t=d(180),s=d(!0);return{hpPerson:e,hpOpponent:t,hpLimit:s}}),qe={class:"test"},Qe={class:"board-wrapper"},Ze={class:"board"},He={class:"btn-panel"},Ae=["disabled"],es={class:"dropdown"},ss=["disabled"],ts={class:"dropdown-menu"},ns=["onClick"],as=["disabled"],os=b({__name:"GameBoard",setup(e){De(I=>({"6c7ad3d0":ie.value+"px"}));const t=L("difficultToProcess"),s=L("isInitialWidth"),a=()=>{t.value=p.value},n=M(),{hpLimit:o}=S(n),u=d(W.SMALL_FIELD),r=d(m.NONE),c=d(!1),{difficult:p,fields:h,init:$}=je(u),{start:x,canStartGame:y,canReset:V,canResize:U,rerolCount:T}=Ye($,h,p,u,r,a,c),{selectField:J,isNext:Pe,isReset:ye}=Ke(h,r,p,x),we=()=>{$(),p.value=2,a(),o.value=!0,s.value=!1,V.value=!1,U.value=!0,r.value=m.NONE,T.value=1},ie=d(275),K=d("Старт"),q=[{value:W.SMALL_FIELD,sizeText:"5 x 5",width:[180,275]},{value:W.MEDIUM_FIELD,sizeText:"6 x 6",width:[204,330]},{value:W.LARGE_FIELD,sizeText:"7 x 7",width:[238,385]}],F=d(W.SMALL_FIELD),Le=E(()=>{const I=q.find(B=>B.value===F.value);return I?I.sizeText:""}),Q=()=>{c.value=!c.value},xe=I=>{F.value=I,Q(),X()},X=()=>{const{width:I}=q.find(({value:B})=>B===F.value);ie.value=window.innerWidth<=896?I[0]:I[1]};return g(r,I=>{I===m.NONE||I===m.RESET?K.value="Старт":K.value="Рерол"}),g(()=>F.value,I=>{u.value=I,$()}),Y(()=>{window.addEventListener("resize",X),X()}),be(()=>{window.removeEventListener("resize",X)}),(I,B)=>(i(),_("div",qe,[l("div",Qe,[l("div",Ze,[(i(!0),_(N,null,ee(v(h),k=>(i(),O(Xe,{"game-status":r.value,key:"item-"+k.id,field:k,onSelectField:B[0]||(B[0]=ue=>v(J)(ue))},null,8,["game-status","field"]))),128))]),f(Ue,{difficult:v(p),isNext:v(Pe),isReset:v(ye)},null,8,["difficult","isNext","isReset"]),l("div",He,[l("button",{class:"btn btn-start",onClick:B[1]||(B[1]=(...k)=>v(x)&&v(x)(...k)),disabled:!v(y)},R(K.value),9,Ae),l("div",es,[l("button",{class:"btn btn-field-size",onClick:Q,disabled:!v(U)},R(Le.value),9,ss),se(l("div",ts,[(i(),_(N,null,ee(q,k=>l("li",{class:Ie(["dropdown-item",{active:k.value===F.value}]),key:k.value,onClick:ue=>(xe(k.value),Q)},R(k.sizeText),11,ns)),64))],512),[[Oe,c.value]])]),l("button",{class:"btn btn-reset",onClick:we,disabled:!v(V)}," Сброс ",8,as)])])]))}});const ls=P(os,[["__scopeId","data-v-6b4678f6"]]),rs={class:"image-frame"},is=["src"],us=b({__name:"GamePersonImage",props:{imageUrl:{}},setup(e){return(t,s)=>(i(),_("div",rs,[l("img",{class:"sizeimg",src:t.imageUrl,alt:""},null,8,is)]))}});const cs=P(us,[["__scopeId","data-v-dd53a96d"]]),ds={class:"progress-bar-frame"},_s=b({__name:"GamePersonProgressBar",props:{progressBarWidth:{}},setup(e){const t=e,s=L("difficultToJournal"),a=L("isInitialWidth"),n=M(),{hpPerson:o,hpLimit:u}=S(n),r=d(1),c=E(()=>{if(u.value){if(!a.value)return o.value=180,o.value;if([10,15,20,25,30,35].includes(t.progressBarWidth.shift)&&a.value)return o.value=o.value-j(r.value-j(0,5),r.value+j(-7,2)),o.value}});return g(()=>t.progressBarWidth.shift,p=>{[10,15,20,25,30,35].includes(p)?r.value=p:r.value=10}),g(()=>o.value,p=>{p<0&&(console.log("персон стал 0"),o.value=0,u.value=!1)}),g(()=>c.value,(p,h=180)=>{p&&(s.value=h-p),p||(s.value=-h),console.log(`difficultToJournal.value ${s.value} = oldHp ${h} - newHp ${p}`)}),(p,h)=>(i(),_("div",ds,[l("div",{class:"progress-bar",style:ae({width:v(o)+"px"})},null,4)]))}});const ps=P(_s,[["__scopeId","data-v-89149b56"]]);async function G(e){return new Promise((t,s)=>{const a=new Image;a.src=e,a.onload=()=>t(),a.onerror=()=>s()})}const H=""+new URL("nezuko_small.bf4553ee.jpg",import.meta.url).href,ve=""+new URL("nezuko_medium.8242457b.jpg",import.meta.url).href,me=""+new URL("nezuko_high.de54f236.jpg",import.meta.url).href,vs={class:"container-person"},ms=b({__name:"GamePerson",setup(e){const t=L("difficultToProcess"),s=d({shift:0}),a=E(()=>{switch(t.value){case 2:return H;case 4:return ve;case 6:return me;default:return H}});return g(t,n=>{[2,4,6,8,10].includes(n)?s.value={shift:(n/2+1)*5}:s.value={shift:35}}),Y(async()=>{await Promise.all([G(H),G(ve),G(me)])}),(n,o)=>(i(),_("div",vs,[C(n.$slots,"image",{},()=>[(i(),O(cs,{"image-url":a.value,key:v(t)},null,8,["image-url"]))],!0),C(n.$slots,"bar",{},()=>[f(ps,{"progress-bar-width":s.value},null,8,["progress-bar-width"])],!0)]))}});const te=P(ms,[["__scopeId","data-v-a0250405"]]),fs={class:"image-frame-opponent"},gs=["src"],hs=b({__name:"GameOpponentImage",props:{imageUrl:{}},setup(e){return(t,s)=>(i(),_("div",fs,[l("img",{class:"sizeimg",src:t.imageUrl,alt:""},null,8,gs)]))}});const Is=P(hs,[["__scopeId","data-v-5dab152c"]]),bs={class:"progress-bar-frame"},$s=b({__name:"GameOpponentProgressBar",props:{progressBarWidth:{}},setup(e){const t=e,s=L("isInitialWidth"),a=M(),{hpOpponent:n}=S(a);return g([()=>t.progressBarWidth.shift,()=>s.value],([o,u])=>{if(!u)return n.value=180,n.value;if([10,15,20,25,30,35,40].includes(o)&&u)return n.value=n.value-o,n.value}),g(()=>n.value,o=>{o<0&&(n.value=0)}),(o,u)=>(i(),_("div",bs,[l("div",{class:"progress-bar",style:ae({width:v(n)+"px"})},null,4)]))}});const Es=P($s,[["__scopeId","data-v-05d5610e"]]),A=""+new URL("small_luna.4d1b861e.png",import.meta.url).href,fe=""+new URL("medium_luna.863f2036.jpg",import.meta.url).href,ge=""+new URL("high_luna.30ce6d87.jpg",import.meta.url).href,Ps={class:"container-opponent"},ys=b({__name:"GameOpponent",setup(e){const t=L("difficultToProcess"),s=d({shift:0}),a=E(()=>{switch(t.value){case 2:return A;case 4:return fe;case 6:return ge;default:return A}});return g(t,n=>{[2,4,6,8,10,12,14].includes(n)?s.value={shift:(n/2+1)*5}:s.value={shift:45}}),Y(async()=>{await Promise.all([G(A),G(fe),G(ge)])}),(n,o)=>(i(),_("div",Ps,[C(n.$slots,"image",{},()=>[(i(),O(Is,{"image-url":a.value,key:v(t)},null,8,["image-url"]))],!0),C(n.$slots,"bar",{},()=>[f(Es,{"progress-bar-width":s.value},null,8,["progress-bar-width"])],!0)]))}});const ne=P(ys,[["__scopeId","data-v-39b8ecf4"]]),ws={class:"journal"},Ls=b({__name:"Journal",props:{log:{}},setup(e){const t=e,s=d(!1);return g(()=>t.log.length,a=>{s.value=a>=3}),(a,n)=>(i(),_("div",ws,[f(Ne,{name:"slide-fade",tag:"ul",class:"log-container",style:ae({resize:s.value?"vertical":"none"})},{default:w(()=>[(i(!0),_(N,null,ee(a.log,o=>(i(),_("li",{key:o.time,class:"log-entry"},[o.isNewGame?(i(),_(N,{key:0},[ce(" Вы начали заново в "+R(o.time),1)],64)):(i(),_(N,{key:1},[ce(R(o.attacker)+" нанес "+R(o.damagePerson)+" урона, получив от противника "+R(o.damageOpponent)+" урона - "+R(o.time),1)],64))]))),128))]),_:1},8,["style"])]))}});const xs=P(Ls,[["__scopeId","data-v-d7a55abb"]]),Rs=b({__name:"GameJournal",setup(e){const t=L("difficultToProcess"),s=L("difficultToJournal"),a=L("isInitialWidth"),n=d([]),o=E(()=>{if(t.value===2)return 10;if(t.value===4)return 15;if(t.value===6)return 20;if(t.value===8)return 25;if(t.value===10)return 30;if(t.value===12)return 35;if(t.value===14)return 40;if(t.value===16)return 45});return g([t,a],()=>{if(!a.value)n.value=[{isNewGame:!0,time:new Date().toLocaleTimeString()}];else{const r=s.value,c=new Date().toLocaleTimeString();n.value.unshift({attacker:"Nezuko",damagePerson:o.value,damageOpponent:r,time:c})}}),(r,c)=>(i(),_("div",null,[f(xs,{log:n.value},null,8,["log"])]))}}),re=e=>(oe("data-v-318c567e"),e=e(),le(),e),ks=re(()=>l("hr",null,null,-1)),Ts={key:2,class:"draw"},Bs=re(()=>l("div",{class:"space"},null,-1)),Ds=re(()=>l("hr",null,null,-1)),Os={class:"footer"},Ns=b({__name:"PopupSlots",props:{isOpen:{type:Boolean,default:()=>!1},gameResult:{default:()=>"draw"}},emits:["close-popup"],setup(e,{emit:t}){const s=e,a=o=>{s.isOpen&&o.key==="Escape"&&n()},n=()=>{t("close-popup")};return Y(()=>{document.addEventListener("keydown",a)}),be(()=>{document.removeEventListener("keydown",a)}),(o,u)=>o.isOpen?(i(),_("div",{key:0,class:"backdrop",onMousedown:n},[l("div",{class:"popup",onMousedown:u[0]||(u[0]=Ge(()=>{},["stop"]))},[l("h2",null,R(o.gameResult==="draw"?"Ничья!":"Победа:"),1),ks,o.gameResult==="person"?(i(),O(te,{key:0},{image:w(()=>[]),bar:w(()=>[]),_:1})):o.gameResult==="opponent"?(i(),O(ne,{key:1},{image:w(()=>[]),bar:w(()=>[]),_:1})):o.gameResult==="draw"?(i(),_("div",Ts,[f(te,null,{image:w(()=>[]),bar:w(()=>[]),_:1}),Bs,f(ne,null,{image:w(()=>[]),bar:w(()=>[]),_:1})])):z("",!0),Ds,l("div",Os,[C(o.$slots,"actions",{close:n},()=>[l("button",{class:"btn",onClick:n},"Спасибо")],!0)])],32)],32)):z("",!0)}});const Gs=P(Ns,[["__scopeId","data-v-318c567e"]]),Fs=b({__name:"PopupInit",setup(e){const t=M(),{hpPerson:s,hpOpponent:a}=S(t),n=d(!1),o=E(()=>{if(s.value===0&&a.value>0)return"opponent";if(a.value===0&&s.value>0)return"person";if(s.value===0&&a.value===0)return"draw"});return g([s,a],([u,r])=>{(u<=0||r<=0)&&(n.value=!0)}),(u,r)=>(i(),O(Fe,{to:"body"},[f(he,{name:"popup"},{default:w(()=>[f(Gs,{"game-result":o.value,"is-open":n.value,onClosePopup:r[0]||(r[0]=c=>n.value=!1)},null,8,["game-result","is-open"])]),_:1})]))}});const Ws={},zs=e=>(oe("data-v-c2274568"),e=e(),le(),e),Cs={class:"backdrop-flip"},Ss=zs(()=>l("div",{class:"screen-rotation"},null,-1)),Ms=[Ss];function Vs(e,t){return i(),_("div",Cs,Ms)}const Us=P(Ws,[["render",Vs],["__scopeId","data-v-c2274568"]]),Js={class:"debug-panel"},Xs={class:"debug-panel-input"},js=l("label",{for:"hp-person"},"HP Person:",-1),Ys=l("label",{for:"hp-opponent"},"HP Opponent:",-1),Ks={key:0,class:"debug-panel-message"},qs={__name:"DebagPanel",setup(e){const t=M(),{hpPerson:s,hpOpponent:a}=S(t),n=d(!0),o=u=>{u>=0&&u<=180?n.value=!0:(n.value=!1,s.value=180,a.value=180)};return(u,r)=>(i(),_("div",Js,[l("div",Xs,[js,se(l("input",{id:"hp-person",type:"number","onUpdate:modelValue":r[0]||(r[0]=c=>_e(s)?s.value=c:null),onInput:r[1]||(r[1]=c=>o(v(s))),min:"0",max:"180"},null,544),[[de,v(s),void 0,{lazy:!0}]]),Ys,se(l("input",{id:"hp-opponent",type:"number","onUpdate:modelValue":r[2]||(r[2]=c=>_e(a)?a.value=c:null),onInput:r[3]||(r[3]=c=>o(v(a))),min:"0",max:"180"},null,544),[[de,v(a),void 0,{lazy:!0}]])]),n.value?z("",!0):(i(),_("div",Ks," Диапазон 0 - 180 "))]))}},Qs=qs,Zs=e=>(oe("data-v-fd8b1d12"),e=e(),le(),e),Hs={class:"wrapper"},As=Zs(()=>l("h2",{class:"h2"},"Коробка удачи",-1)),et={class:"container"},st={class:"game-person"},tt={class:"game-board"},nt={class:"app"},at={class:"game-opponent"},ot=b({__name:"index",setup(e){const t=d(1);Z("difficultToProcess",t);const s=d(1);Z("difficultToJournal",s);const a=d(!0);Z("isInitialWidth",a);const n=d(!1),o=d(0),u=()=>{o.value++,o.value===5&&(n.value=!n.value,o.value=0)};return(r,c)=>(i(),_(N,null,[l("div",Hs,[l("div",{class:"centered-content"},[l("img",{class:"logo",src:We,alt:"Game logo",onClick:u}),As]),l("div",et,[l("div",st,[f(te)]),l("div",tt,[l("div",nt,[f(ls)])]),l("div",at,[f(ne)])]),f(Rs),n.value?(i(),O(Qs,{key:0})):z("",!0)]),f(Fs),f(Us)],64))}});const rt=P(ot,[["__scopeId","data-v-fd8b1d12"]]);export{rt as default};
